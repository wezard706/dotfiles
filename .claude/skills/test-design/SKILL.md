---
name: test-design
description: 単体テストのテスト設計を行う。テスト対象のコードを解析し、適切な技法を選択してテストケースを導出する。
---

# 単体テスト設計

テスト設計技法のリファレンスを読み込む: `./reference.md`

## ワークフロー

### Step 1: コードの解析

会話の文脈から特定されるテスト対象のコードを読み込み、以下を把握する。

- **責務**: このメソッド/クラスが担う責務は何か（複数ある場合はすべて列挙）
- **入力**: 引数、プロパティ、外部状態（DBの値など）
- **出力**: 戻り値、副作用（DBへの書き込み、イベント発火など）
- **分岐**: 条件分岐・例外処理・状態変化のパターン

責務が複数検出された場合は、テスト対象の範囲（どの責務をテストするか）をユーザーに確認してから進むこと。

### Step 2: 技法の選択とテストケース導出

解析結果に基づき、リファレンスの技法選択ガイドを参照して適切な技法を選択し、テストケースを導出する。

目標カバレッジ基準をC0/C1/C2から選択し、テスト設計書に明記すること（基本はC1）。

- **C0（命令網羅）**: 全命令を少なくとも1回実行
- **C1（分岐網羅）**: 全分岐（true/false）を少なくとも1回実行
- **C2（条件網羅）**: 全条件の組み合わせを実行

### Step 3: ユーザーレビュー

導出したテストケース一覧をユーザーに提示し、レビューを受ける。

---

## 出力形式

```markdown
## テスト設計書

### テスト対象: `クラス名#メソッド名`

#### 使用技法
- （使用した技法を列挙）

#### テストケース一覧

| # | テストケース名 | 前提条件 | 入力値 | 期待結果 |
|---|--------------|---------|-------|---------|
| 1 | ... | ... | ... | ... |

**各列の定義**
- **前提条件**: テスト実行前に整えるべき外部状態（DBデータ、オブジェクトの状態、モックの設定など）
- **入力値**: メソッドに直接渡す引数

#### 補足（デシジョンテーブル・状態遷移図など、必要な場合のみ）
```
